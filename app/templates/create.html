{% extends "base.html" %}

{% block title %}CarKeep - Create New Scenario{% endblock %}

{% block content %}
{% from "form_components.html" import basic_info_section, vehicle_details_section, financing_section, trade_in_section, operating_costs_section, form_actions, form_javascript %}

<div class="create-scenario fade-in">
    <div class="create-header">
        <h1>➕ Create New Scenario</h1>
        <p>Add a new vehicle cost comparison scenario to your analysis</p>
        <div class="header-actions">
            <a href="{{ url_for('main.index') }}" class="btn btn-secondary">← Back to Scenarios</a>
        </div>
    </div>
    
    <div class="create-form">
        <form method="POST" action="{{ url_for('main.create_scenario') }}" id="scenarioForm">
            {{ basic_info_section() }}
            {{ vehicle_details_section() }}
            {{ financing_section() }}
            {{ trade_in_section() }}
            {{ operating_costs_section() }}
            {{ form_actions(submit_text="Create Scenario") }}
        </form>
    </div>
</div>

<script>
// Form submission handler
document.getElementById('scenarioForm').addEventListener('submit', function(e) {
    const scenarioName = document.getElementById('scenario_name').value;
    const pattern = /^[a-z0-9_]+$/;
    
    if (!pattern.test(scenarioName)) {
        e.preventDefault();
        alert('Scenario name must contain only lowercase letters, numbers, and underscores.');
        return false;
    }
    
    // Show loading state
    const submitBtn = document.querySelector('button[type="submit"]');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoading = submitBtn.querySelector('.btn-loading');
    
    btnText.style.display = 'none';
    btnLoading.style.display = 'inline';
    submitBtn.disabled = true;
});
</script>

{{ form_javascript() }}
{% endblock %}
